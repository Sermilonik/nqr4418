<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–æ–≤ - –°–∫–ª–∞–¥</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <a href="index.html" class="back-button">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <h1>üì¶ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–æ–≤</h1>
            <p class="subtitle">–°–∫–ª–∞–¥—Å–∫–æ–π –º–æ–¥—É–ª—å</p>
        </header>

        <!-- –í—ã–±–æ—Ä –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ -->
        <div class="card">
            <h3>1. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤</h3>

            <!-- –ü–æ–∏—Å–∫ –∏ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ -->
            <div class="contractor-search">
                <div class="search-container">
                    <input type="text" id="contractorSearch" placeholder="üîç –ù–∞–π—Ç–∏ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞..." class="form-select">
                    <button id="closeDropdown" class="btn btn-sm btn-outline hidden">
                        ‚úï
                    </button>
                </div>
                <div id="contractorDropdown" class="contractor-dropdown hidden">
                    <!-- –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>

            <!-- –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã -->
            <div id="selectedContractors" class="selected-contractors">
                <div class="selected-header">
                    <span>–í—ã–±—Ä–∞–Ω–æ: <span id="selectedCount">0</span></span>
                    <button class="btn btn-sm btn-outline" onclick="window.scannerManager.clearContractors()">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>
                <div id="contractorsList" class="contractors-list">
                    <!-- –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏ -->
        <div class="card">
            <div class="card-header">
                <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏</h3>
                <button class="btn btn-sm btn-primary" onclick="scannerManager.showContractorManager()">
                    ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                </button>
            </div>
            <div class="contractor-stats">
                <span class="badge">–í—Å–µ–≥–æ: <span id="totalContractors">0</span></span>
                <span class="badge">–ó–∞–≥—Ä—É–∂–µ–Ω–æ: <span id="loadedContractors">4</span></span>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å —Å–µ—Å—Å–∏–∏ -->
        <div id="sessionStatus" class="card status-card hidden">
            <div class="status-header">
                <span id="statusIcon">‚è≥</span>
                <h3 id="statusTitle">–°–µ—Å—Å–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            </div>
            <div class="status-info">
                <div class="status-item">
                    <span class="label">–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç:</span>
                    <span id="currentContractor">-</span>
                </div>
                <div class="status-item">
                    <span class="label">–û—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –∫–æ–¥–æ–≤:</span>
                    <span id="codesCount" class="badge">0</span>
                </div>
                <div class="status-item">
                    <span class="label">ID —Å–µ—Å—Å–∏–∏:</span>
                    <span id="sessionId">-</span>
                </div>
            </div>
        </div>

        <!-- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ -->
        <div class="card">
            <h3>2. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–æ–≤</h3>
            
            <div class="scan-controls">
                <button id="startCamera" class="btn btn-primary" disabled>
                    <span class="btn-icon">üì∑</span>
                    –í–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É
                </button>
                <button id="stopCamera" class="btn btn-secondary hidden">
                    <span class="btn-icon">‚èπÔ∏è</span>
                    –í—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É
                </button>
                <button id="showSimulator" class="btn btn-outline">
                    <span class="btn-icon">üß™</span>
                    –°–∏–º—É–ª—è—Ç–æ—Ä —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                </button>
            </div>

            <div id="reader" class="scanner-container hidden">
                <div class="scanner-placeholder">
                    <span class="placeholder-icon">üì∑</span>
                    <p>–ö–∞–º–µ—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞. –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ QR-–∫–æ–¥</p>
                </div>
            </div>

            <!-- –°–∏–º—É–ª—è—Ç–æ—Ä -->
            <div id="simulator" class="simulator hidden">
                <h4>üß™ –°–∏–º—É–ª—è—Ç–æ—Ä —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h4>
                <p>–¢–µ—Å—Ç–æ–≤—ã–µ QR-–∫–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã:</p>
                
                <div class="test-codes-grid">
                    <div class="test-code" onclick="scannerManager.simulateScan('0104604063405720219NQNfSwVmcTEST001')">
                        <span class="code-preview">0104604063405720219NQNfSwVmcTEST001</span>
                        <button class="btn btn-sm">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                    <div class="test-code" onclick="scannerManager.simulateScan('0104604063405720219NQNfSwVmdTEST002')">
                        <span class="code-preview">0104604063405720219NQNfSwVmdTEST002</span>
                        <button class="btn btn-sm">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                    <div class="test-code" onclick="scannerManager.simulateScan('0104604063405720219NQNfSwVmeTEST003')">
                        <span class="code-preview">0104604063405720219NQNfSwVmeTEST003</span>
                        <button class="btn btn-sm">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                    <div class="test-code" onclick="scannerManager.simulateScan('0104604063405720219NQNfSwVmfTEST004')">
                        <span class="code-preview">0104604063405720219NQNfSwVmfTEST004</span>
                        <button class="btn btn-sm">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                </div>

                <div class="simulator-actions">
                    <button onclick="scannerManager.simulateMultipleScans()" class="btn btn-outline">
                        üîÑ –î–æ–±–∞–≤–∏—Ç—å 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–æ–¥–æ–≤
                    </button>
                    <button onclick="scannerManager.hideSimulator()" class="btn btn-secondary">
                        ‚úï –ó–∞–∫—Ä—ã—Ç—å —Å–∏–º—É–ª—è—Ç–æ—Ä
                    </button>
                </div>
            </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –∫–æ–¥–æ–≤ -->
        <div class="card">
            <div class="card-header">
                <h3>3. –û—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã</h3>
                <span id="totalCodes" class="badge">0</span>
            </div>
            
            <div id="codesList" class="codes-list">
                <div class="empty-state">
                    <span class="empty-icon">üì¶</span>
                    <p>–ù–µ—Ç –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤</p>
                    <small>–ù–∞—á–Ω–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–º—É–ª—è—Ç–æ—Ä</small>
                </div>
            </div>
        </div>

        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <div class="card">
            <h3>4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞</h3>
            <div class="actions-grid">
                <button id="generateReport" class="btn btn-success" disabled>
                    <span class="btn-icon">üìÑ</span>
                    –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
                </button>
                <button id="clearSession" class="btn btn-danger">
                    <span class="btn-icon">üóëÔ∏è</span>
                    –û—á–∏—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏—é
                </button>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å—ã –æ—Ç—á–µ—Ç–æ–≤ -->
        <div class="card">
            <div class="card-header">
                <h3>üìä –ò—Å—Ç–æ—Ä–∏—è –æ—Ç—á–µ—Ç–æ–≤</h3>
                <button id="refreshReports" class="btn btn-sm btn-outline">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        <!-- –°—Ç–∞—Ç—É—Å—ã –æ—Ç—á–µ—Ç–æ–≤ -->
    <div class="card">
        <div class="card-header">
            <h3>üìä –ò—Å—Ç–æ—Ä–∏—è –æ—Ç—á–µ—Ç–æ–≤</h3>
            <div>
                <button id="deleteAllPending" class="btn btn-sm btn-danger">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ</button>
                <button id="refreshReports" class="btn btn-sm btn-outline">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>
    
        <div id="reportsList" class="reports-list">
            <div class="empty-state">
                <span class="empty-icon">üìÑ</span>
                <p>–ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤</p>
                <small>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</small>
            </div>
        </div>
    </div>
            <div id="reportsList" class="reports-list">
                <div class="empty-state">
                    <span class="empty-icon">üìÑ</span>
                    <p>–ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤</p>
                    <small>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="notificationContainer"></div>

    <!-- –ü–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏ -->
    <div id="warehouseNotifications" class="notifications-panel hidden">
        <div class="notifications-header">
            <h4>üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏</h4>
            <button onclick="scannerManager.hideNotifications()" class="btn btn-sm btn-secondary">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        <div id="notificationsList" class="notifications-list">
            <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <!-- –î–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ -->
    <div class="card">
        <h3>üõ† –û—Ç–ª–∞–¥–∫–∞</h3>
        <button onclick="scannerManager.debugInfo()" class="btn btn-outline">‚ÑπÔ∏è –ò–Ω—Ñ–æ</button>
        <button onclick="scannerManager.forceRestoreSession()" class="btn btn-outline">üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
    </div>
    
    <!-- –í—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏ -->
    <div class="card">
        <h3>üß™ –¢–µ—Å—Ç —Å–µ—Å—Å–∏–∏</h3>
        <button onclick="scannerManager.createTestSession()" class="btn btn-outline">üîÑ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å–µ—Å—Å–∏—é</button>
        <button onclick="scannerManager.debugSession()" class="btn btn-outline">üêõ –û—Ç–ª–∞–¥–∫–∞ —Å–µ—Å—Å–∏–∏</button>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <button id="showNotifications" class="notification-bell" onclick="scannerManager.showNotifications()">
        üîî <span id="notificationCount" class="notification-badge hidden">0</span>
    </button>

    <!-- –ë–ò–ë–õ–ò–û–¢–ï–ö–ò -->
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@pdf-lib/fontkit@1.1.1/dist/fontkit.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bwip-js@2.1.2/dist/bwip-js.min.js"></script>


    <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è PDF -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/@pdf-lib/fontkit@1.1.1/dist/fontkit.umd.min.js"></script>

    <!-- –ù–ê–®–ò –°–ö–†–ò–ü–¢–´ - –¢–û–õ–¨–ö–û –û–î–ò–ù –†–ê–ó –ö–ê–ñ–î–´–ô -->
    <script src="js/utils.js"></script>
    <script src="js/app-state.js"></script>
    <script src="js/pdf-generator.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/scanner.js"></script>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏ -->
<div id="contractorManager" class="modal-overlay hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏</h3>
            <button class="btn btn-sm btn-secondary" onclick="scannerManager.hideContractorManager()">
                ‚úï –ó–∞–∫—Ä—ã—Ç—å
            </button>
        </div>
        
        <div class="modal-body">
            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="quick-actions">
                <button class="btn btn-success" onclick="scannerManager.showAddContractorForm()">
                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
                </button>
                <button class="btn btn-outline" onclick="scannerManager.exportContractors()">
                    üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
                </button>
                <button class="btn btn-outline" onclick="scannerManager.showImportForm()">
                    üì• –ò–º–ø–æ—Ä—Ç –∏–∑ CSV
                </button>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ -->
            <div id="addContractorForm" class="form-section hidden">
                <h4>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</h4>
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="contractorName" class="form-select" placeholder="–û–û–û –†–æ–º–∞—à–∫–∞">
                </div>
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                    <input type="text" id="contractorCategory" class="form-select" placeholder="–û–ø—Ç–æ–≤—ã–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å">
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" onclick="scannerManager.addContractor()">
                        ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button class="btn btn-outline" onclick="scannerManager.hideAddContractorForm()">
                        ‚ùå –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –∏–º–ø–æ—Ä—Ç–∞ -->
            <div id="importForm" class="form-section hidden">
                <h4>–ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤</h4>
                <div class="form-group">
                    <label>CSV –¥–∞–Ω–Ω—ã–µ (–ù–∞–∑–≤–∞–Ω–∏–µ,–ö–∞—Ç–µ–≥–æ—Ä–∏—è):</label>
                    <textarea id="importData" class="form-select" rows="6" placeholder="–û–û–û –†–æ–º–∞—à–∫–∞,–û–ø—Ç–æ–≤—ã–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å
–ò–ü –ò–≤–∞–Ω–æ–≤,–†–æ–∑–Ω–∏—á–Ω–∞—è —Å–µ—Ç—å
–û–û–û –õ—É—á,–î–∏–ª–µ—Ä"></textarea>
                </div>
                <div class="form-help">
                    <small>–§–æ—Ä–º–∞—Ç: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ - –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç, –ø–æ–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∑–∞–ø—è—Ç—ã–º–∏</small>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" onclick="scannerManager.importContractors()">
                        üì• –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-outline" onclick="scannerManager.hideImportForm()">
                        ‚ùå –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ -->
            <div class="contractors-list-section">
                <h4>–°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤</h4>
                <div class="search-box">
                    <input type="text" id="managerSearch" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤..." class="form-select" 
                           oninput="scannerManager.filterContractorsList()">
                </div>
                <div id="contractorsManagerList" class="contractors-manager-list">
                    <!-- –°–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>